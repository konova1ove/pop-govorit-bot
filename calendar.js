const orthodoxEvents = {
  // 2025
  '01-01': 'Обрезание Господне',
  '01-07': 'Рождество Христово',
  '01-19': 'Крещение Господне',
  '02-02': 'Сретение Господне',
  '04-07': 'Благовещение Пресвятой Богородицы',
  '05-09': 'День Победы и поминовение усопших',
  '07-07': 'Рождество Иоанна Предтечи',
  '07-12': 'Святых апостолов Петра и Павла',
  '08-06': 'Преображение Господне',
  '08-15': 'Успение Пресвятой Богородицы',
  '08-29': 'Усекновение главы Иоанна Предтечи',
  '09-08': 'Рождество Пресвятой Богородицы',
  '09-14': 'Воздвижение Креста Господня',
  '09-21': 'Рождество Пресвятой Богородицы',
  '10-01': 'Покров Пресвятой Богородицы',
  '10-14': 'Покров Пресвятой Богородицы',
  '11-04': 'Казанской иконы Божией Матери',
  '11-21': 'Собор Архистратига Михаила',
  '12-04': 'Введение во храм Пресвятой Богородицы',
  '12-06': 'Святителя Николая Чудотворца',
  '12-19': 'Святителя Николая Чудотворца',
  '12-25': 'Рождественский сочельник'
};

// Пасха и зависимые праздники на конкретные годы
const pascha = {
  2025: new Date(2025, 3, 20), // 20 апреля 2025
  2026: new Date(2026, 3, 12)  // 12 апреля 2026
};

const prayers = [
  'Господи, благослови день сей',
  'Пресвятая Богородице, спаси нас',
  'Святче Божий, моли Бога о нас',
  'Господи Иисусе Христе, помилуй нас',
  'Богородице Дево, радуйся',
  'Святый Боже, Святый Крепкий',
  'Слава Отцу и Сыну и Святому Духу',
  'И ныне и присно и во веки веков',
  'Царю Небесный, Утешителю',
  'Трисвятое по Отче наш',
  'Под Твою милость прибегаем',
  'Достойно есть яко воистину',
  'Взбранной Воеводе победительная',
  'О Пресвятая Троице, помилуй нас',
  'Господи и Владыко живота моего',
  'Боже милостив буди мне грешному',
  'Помяни мя, Господи, во Царствии Твоем',
  'Пресвятая Троице, единосущная державо',
  'Символ веры во Единаго Бога',
  'Молитва Господня Отче наш'
];

const prayerVariations = [
  'Аминь, братие',
  'Да будет воля Божия',
  'Слава Богу за все',
  'Бог в помощь',
  'С Богом',
  'Помоги, Господи',
  'Благослови, Отче',
  'Спаси и сохрани',
  'Царствие Небесное',
  'Многая и благая лета'
];

function getOrthodoxEvent(date) {
  const year = date.getFullYear();
  const monthDay = String(date.getMonth() + 1).padStart(2, '0') + '-' + 
                   String(date.getDate()).padStart(2, '0');
  
  // Проверяем Пасху
  if (pascha[year] && isSameDay(date, pascha[year])) {
    return { type: 'pascha', name: 'Пасха Христова' };
  }
  
  // Проверяем обычные праздники
  if (orthodoxEvents[monthDay]) {
    return { type: 'feast', name: orthodoxEvents[monthDay] };
  }
  
  // Возвращаем молитву с вариацией
  const prayerIndex = date.getDate() % prayers.length;
  const variationIndex = (date.getDate() + date.getMonth()) % prayerVariations.length;
  
  // Иногда добавляем благословение (30% вероятность)
  const blessing = Math.random() > 0.7 ? `. ${prayerVariations[variationIndex]}` : '';
  
  return { 
    type: 'prayer', 
    name: prayers[prayerIndex] + blessing
  };
}

function isSameDay(date1, date2) {
  return date1.getFullYear() === date2.getFullYear() &&
         date1.getMonth() === date2.getMonth() &&
         date1.getDate() === date2.getDate();
}

module.exports = { getOrthodoxEvent };